<!DOCTYPE html>
<html lang="en">
  <head>
    <title>User profile</title>
    <%= erb :head %>
    <%= erb :libs %>
  </head>
  <body>
    <%= erb :nav %>
    <div class="container">
      <section id="content">
        <div class="row">
          <%= erb :sidebar %>
          <div class="span10">
            <h1>User: <%= @user.name %></h1>

            <% if @user.image_file_name %>
            <img style="width:300px" src='<%= @HOSTNAME+"/userimages/"+@user.image_file_name %>'/>
            <% end %>

            <% if @user.interests.length > 0 %>
            <p>Interests: <%=@user.interests%></p>
            <% end %>

            <h3 style="padding-top: 50px;">User's items</h3>

            <% if @user.items.size > 0%>
            <table class="table">
              <thead>
                <th>Name</th>
                <th>Price</th>
                <th>State</th>
              </thead>
              <tbody>
                <% for item in @user.items %>
                <tr>
                  <td><%= item.name %></td>
                  <td><%= item.price %></td>
                  <% if item.active %>
                      <%if @user == @current_user %>
                          <td style="color:#00CC00;">Active</td>
                          <td>
                            <form action="/status_change" method="post">
                              <input type="hidden" name="owner" value="<%= item.owner.name %>" />
                              <input type="hidden" name="item" value="<%= item.id %>" />
                              <input type="hidden" name="new_state" value="inactive" />
                              <input type="submit" class="btn btn-info small" name="submit" value="Inactivate item" />
                            </form>
                          </td>
                      <% else %>
                          <td>
                            <input type="submit" class="btn btn-info small" name="submit" value="Buy Item" />
                          </td>
                      <% end %>
                  <% else %>
                      <%if @user == @current_user %>
                          <td style="color:#FF0000;">Inactive</td>
                          <td>
                            <form action="/status_change" method="post">
                              <input type="hidden" name="owner" value="<%= item.owner.name %>" />
                              <input type="hidden" name="item" value="<%= item.id %>" />
                              <input type="hidden" name="new_state" value="active" />
                              <input type="submit" class="btn btn-info small" name="submit" value="Activate item" />
                            </form>
                          </td>
                      <% else %>
                        <td style="color:#FF0000;">Inactive</td>
                      <% end %>
                  <% end %>
                </tr>
                <% end %>
              </tbody>
            </table>
            <% else %>
            <i>This user has no items.</i>
            <% end %>
          </div>
        </div>
      </section>
    </div>


